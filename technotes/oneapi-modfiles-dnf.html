<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">


<title>Updating oneAPI Module Files using DNF &#8211; Ian McInerney</title>
<meta name="description" content="The Intel oneAPI tools do not automatically create module files when they are installed using DNF (or remove old module files when they are removed).
Instead, a DNF action plugin can be used to run the modulefiles setup script after and DNF transaction modifying an Intel package.
The plugin architecture changed between DNF 4 and DNF 5, so slightly different steps are needed for each one.
">
<meta name="keywords" content="">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Updating oneAPI Module Files using DNF">
<meta name="twitter:description" content="The Intel oneAPI tools do not automatically create module files when they are installed using DNF (or remove old module files when they are removed).
Instead, a DNF action plugin can be used to run the modulefiles setup script after and DNF transaction modifying an Intel package.
The plugin architecture changed between DNF 4 and DNF 5, so slightly different steps are needed for each one.
">



<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Updating oneAPI Module Files using DNF">
<meta property="og:description" content="The Intel oneAPI tools do not automatically create module files when they are installed using DNF (or remove old module files when they are removed).
Instead, a DNF action plugin can be used to run the modulefiles setup script after and DNF transaction modifying an Intel package.
The plugin architecture changed between DNF 4 and DNF 5, so slightly different steps are needed for each one.
">
<meta property="og:url" content="/technotes/oneapi-modfiles-dnf.html">
<meta property="og:site_name" content="Ian McInerney">

<meta property="og:image" content="/images/default-thumb.png">


<!-- Webmaster Tools verfication -->
<meta name="google-site-verification" content="sNKIqFj27iemOFAuKFdpu_3ToTkm41gcB1vy3ZzbGk4">



<link rel="canonical" href="/technotes/oneapi-modfiles-dnf.html">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Ian McInerney Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/academicons/css/academicons.css"/>
<link rel="stylesheet" href="/assets/css/bootstrap.min.css">
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">


<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

<script
  type="text/javascript"
  src="https://use.fontawesome.com/releases/v5.15.1/js/conflict-detection.js">
</script>

<!--Jekyll-seo plugin-->
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Updating oneAPI Module Files using DNF | Ian McInerney</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Updating oneAPI Module Files using DNF" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The Intel oneAPI tools do not automatically create module files when they are installed using DNF (or remove old module files when they are removed). Instead, a DNF action plugin can be used to run the modulefiles setup script after and DNF transaction modifying an Intel package. The plugin architecture changed between DNF 4 and DNF 5, so slightly different steps are needed for each one." />
<meta property="og:description" content="The Intel oneAPI tools do not automatically create module files when they are installed using DNF (or remove old module files when they are removed). Instead, a DNF action plugin can be used to run the modulefiles setup script after and DNF transaction modifying an Intel package. The plugin architecture changed between DNF 4 and DNF 5, so slightly different steps are needed for each one." />
<link rel="canonical" href="https://ism.engineer/technotes/oneapi-modfiles-dnf.html" />
<meta property="og:url" content="https://ism.engineer/technotes/oneapi-modfiles-dnf.html" />
<meta property="og:site_name" content="Ian McInerney" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-19T15:24:45+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Updating oneAPI Module Files using DNF" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-05-19T15:24:45+00:00","datePublished":"2025-05-19T15:24:45+00:00","description":"The Intel oneAPI tools do not automatically create module files when they are installed using DNF (or remove old module files when they are removed). Instead, a DNF action plugin can be used to run the modulefiles setup script after and DNF transaction modifying an Intel package. The plugin architecture changed between DNF 4 and DNF 5, so slightly different steps are needed for each one.","headline":"Updating oneAPI Module Files using DNF","mainEntityOfPage":{"@type":"WebPage","@id":"https://ism.engineer/technotes/oneapi-modfiles-dnf.html"},"url":"https://ism.engineer/technotes/oneapi-modfiles-dnf.html"}</script>
<!-- End Jekyll SEO tag -->


</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<div class="grid-top">
			<div class="grid-name">
				<h3 itemprop="name" class="author-name">Ian McInerney</h3>
			</div>
			<div class="grid-links">
				<a href="mailto:ian.s.mcinerney@ieee.org" class="social-links" target="_blank"><i class="fas fa-fw fa-envelope-square"></i></a>
				
				<a href="https://scholar.google.com/citations?user=FhYROr4AAAAJ" class="social-links" target="_blank"><i class="ai ai-fw ai-google-scholar"></i></a>
				<a href="https://arxiv.com/a/mcinerney_i_1" class="social-links" target="_blank"><i class="ai ai-fw ai-arxiv"></i></a>
				<a href="https://orcid.org/0000-0003-2616-9771" class="social-links" target="_blank"><i class="ai ai-fw ai-orcid"></i></a>
				<a href="https://linkedin.com/in/ian-mcinerney-933772123" class="social-links" target="_blank"><i class="fab fa-fw fa-linkedin"></i></a>
				<a href="https://github.com/imciner2" class="social-links" target="_blank"><i class="fab fa-fw fa-github"></i></a>
				<a href="https://gitlab.com/imcinerney" class="social-links" target="_blank"><i class="fab fa-fw fa-gitlab"></i></a>
			</div>
			<div class="grid-photo">
				
					<img src="/images/headshot.jpg" class="bio-photo" alt="Ian McInerney photo">
				
			</div>
			<div class="grid-menu">
				<nav role="navigation" id="site-nav" class="nav">
				    <ul>
				        
						    
						    <li><a href="/" >Home</a></li>
						
						    
						    <li><a href="/research.html" >Research</a></li>
						
						    
						    <li><a href="/publications.html" >Publications</a></li>
						
						    
						    <li><a href="/software.html" >Software</a></li>
						
						    
						    <li><a href="/presentations.html" >Presentations</a></li>
						
						    
						    <li><a href="/technotes" >Technotes</a></li>
						
				    </ul>
				</nav>
			</div>
		</div>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->




<div id="main" role="main">
  <div class="article-author-side">
    

<div itemscope itemtype="https://schema.org/Person">


	<img src="/images/headshot.jpg" class="bio-photo" alt="Ian McInerney photo">


  <h3 itemprop="name">Ian McInerney</h3>
  <p>Research software engineer, Vibration UTC at Imperial College London</p>
  <a href="mailto:ian.s.mcinerney@ieee.org" class="author-social" target="_blank"><i class="fas fa-fw fa-envelope-square"></i> Email</a>
  
  
  <a href="https://scholar.google.com/citations?user=FhYROr4AAAAJ" class="author-social" target="_blank"><i class="ai ai-fw ai-google-scholar"></i> Google Scholar</a>
  <a href="https://arxiv.com/a/mcinerney_i_1" class="author-social" target="_blank"><i class="ai ai-fw ai-arxiv"></i> Arxiv</a>
  <a href="https://orcid.org/0000-0003-2616-9771" class="author-social" target="_blank"><i class="ai ai-fw ai-orcid"></i> ORCID</a>
  <a href="https://dblp.org/pid/213/3009.html" class="author-social" target="_blank"><i class="ai ai-fw ai-dblp"></i> dblp</a>
  <a href="https://www.zotero.org/imcinerney" class="author-social" target="_blank"><i class="ai ai-fw ai-zotero"></i> Zotero</a>
  <a href="https://linkedin.com/in/ian-mcinerney-933772123" class="author-social" target="_blank"><i class="fab fa-fw fa-linkedin"></i> LinkedIn</a>
  
  
  
  <a href="https://github.com/imciner2" class="author-social" target="_blank"><i class="fab fa-fw fa-github"></i> Github</a>
  <a href="https://gitlab.com/imcinerney" class="author-social" target="_blank"><i class="fab fa-fw fa-gitlab"></i> Gitlab</a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <a rel="me" href="https://mathstodon.xyz/@imcinerney" class="author-social" target="_blank"><i class="fab fa-fw fa-mastodon"></i> Mastodon</a>
</div>

  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/technotes/oneapi-modfiles-dnf.html" rel="bookmark" title="Updating oneAPI Module Files using DNF">Updating oneAPI Module Files using DNF</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>The Intel oneAPI tools do not automatically create module files when they are installed using DNF (or remove old module files when they are removed).
Instead, a DNF action plugin can be used to run the modulefiles setup script after and DNF transaction modifying an Intel package.
The plugin architecture changed between DNF 4 and DNF 5, so slightly different steps are needed for each one.</p>

<h1 id="dnf-5">DNF 5</h1>

<p>For DNF 5, the libDNF <a href="https://dnf5.readthedocs.io/en/latest/libdnf5_plugins/actions.8.html">actions plugin</a> can be used, but this is not installed by default, so it must be installed manually using the DNF command:</p>
<div id="code-dnf5plugininstall" class="codeblock">
<pre>
dnf install libdnf5-plugin-actions
</pre>
</div>

<p>Once installed, it should be automatically activated, but this can be confirmed by checking the <code class="language-plaintext highlighter-rouge">enabled</code> key in the <code class="language-plaintext highlighter-rouge">/etc/dnf/libdnf5-plugins/actions.conf</code> file.</p>

<p>Next, create the action to update the modulefiles by creating a file <code class="language-plaintext highlighter-rouge">oneapi_modulefiles.actions</code> inside the directory <code class="language-plaintext highlighter-rouge">etc/dnf/libdnf5-plugins/actions.d</code> directory with the contents</p>
<div id="code-dnf5pluginconfig" class="codeblock">
<pre>
# Update the module files for oneAPI if any changes are made in the installation directory
post_transaction:intel-oneapi-*:::/usr/bin/sh -c /opt/intel/oneapi/modulefiles-setup.sh\ --force\ --output-dir=/opt/intel/oneapi/modulefiles\ &gt;&gt;/tmp/intel_modfile.log
</pre>
</div>

<p>Now, anytime a package starting with <code class="language-plaintext highlighter-rouge">intel-oneapi</code> is installed or removed, the modulefiles will be regenerated into the <code class="language-plaintext highlighter-rouge">/opt/intel/oneapi/modulefiles</code> directory.
Note that the output of the modulefile generation script will be sent to the temporary file <code class="language-plaintext highlighter-rouge">/tmp/intel_modfile.log</code> instead of being printed to the terminal.</p>

<h1 id="dnf-4">DNF 4</h1>

<p>For DNF 4, the DNF <a href="https://dnf-plugins-core.readthedocs.io/en/latest/post-transaction-actions.html">post-transactions-actions</a> plugin can be used, but this is not installed by default, so it must be installed manually using the DNF command:</p>
<div id="code-dnf4plugininstall" class="codeblock">
<pre>
dnf install python3-dnf-plugin-post-transaction-actions
</pre>
</div>

<p>Once installed, it should be automatically activated, but this can be confirmed by checking the <code class="language-plaintext highlighter-rouge">enabled</code> key in the <code class="language-plaintext highlighter-rouge">/etc/dnf/plugins/post-transaction-actions.conf</code> file.</p>

<p>Next, create the action to update the modulefiles by creating a file <code class="language-plaintext highlighter-rouge">oneapi_modulefiles.action</code> inside the directory <code class="language-plaintext highlighter-rouge">/etc/dnf/plugins/post-transaction-actions.d</code> directory with the contents</p>
<div id="code-dnf4pluginconfig" class="codeblock">
<pre>
# Update the module files for oneAPI if any changes are made in the installation directory
intel-oneapi-*:any:/opt/intel/oneapi/modulefiles-setup.sh --force --output-dir=/opt/intel/oneapi/modulefiles
</pre>
</div>

<p>Now, anytime a package starting with <code class="language-plaintext highlighter-rouge">intel-oneapi</code> is installed or removed, the modulefiles will be regenerated into the <code class="language-plaintext highlighter-rouge">/opt/intel/oneapi/modulefiles</code> directory.
Note that the output of the modulefile generation script will be printed to the terminal during the DNF transaction.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <!--<h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/technotes/oneapi-modfiles-dnf.html" class="twitter" title="Share on Twitter"><i class="fas fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/technotes/oneapi-modfiles-dnf.html" class="facebook" title="Share on Facebook"><i class="fas fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/technotes/oneapi-modfiles-dnf.html" class="google-plus" title="Share on Google Plus"><i class="fas fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>-->
</div><!-- /.social-share -->

        
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <footer>
    

<span>&copy; 2025 Ian McInerney. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://ncsu-libraries.github.io/jekyll-academic/" rel="nofollow">Jekyll Academic</a> theme.
<br /></span>


  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
